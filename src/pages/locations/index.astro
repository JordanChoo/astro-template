---
/**
 * Locations Listing Page
 *
 * Displays a grid of all locations sorted alphabetically by city,
 * then by state for tie-breaking.
 */

import PageLayout from '../../layouts/PageLayout.astro';
import Breadcrumbs from '../../components/Breadcrumbs.astro';
import SEO from '../../components/SEO.astro';
import LocationCard from '../../components/LocationCard.astro';
import { getSortedLocations } from '../../content/locations/locations.schema';
import { getListingMeta } from '../../data/pages.schema';

const currentPath = Astro.url.pathname;

// Get page metadata from pages.json
const pageMeta = getListingMeta('locations');

// Get all locations sorted by city, then state
const locations = getSortedLocations();
---

<PageLayout title={pageMeta.title}>
  <Fragment slot="head">
    <SEO title={pageMeta.title} description={pageMeta.description} />
  </Fragment>

  <Breadcrumbs currentPath={currentPath} />

  <div class="max-w-7xl mx-auto px-4 py-12 sm:px-6 lg:px-8">
    <!-- Page Header -->
    <div class="text-center mb-12">
      <h1 class="text-3xl sm:text-4xl lg:text-5xl font-bold text-neutral-900 mb-4">
        {pageMeta.title}
      </h1>
      <p class="text-lg sm:text-xl text-neutral-600 max-w-3xl mx-auto">
        {pageMeta.description}
      </p>
    </div>

    {
      locations.length > 0 ? (
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 lg:gap-8">
          {locations.map((location) => (
            <LocationCard
              slug={location.slug}
              city={location.city}
              state={location.state}
              description={location.description}
            />
          ))}
        </div>
      ) : (
        <div class="text-center py-16">
          <div class="w-16 h-16 bg-neutral-100 rounded-full flex items-center justify-center mx-auto mb-4">
            <svg
              class="w-8 h-8 text-neutral-400"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              aria-hidden="true"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"
              />
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"
              />
            </svg>
          </div>
          <h2 class="text-xl font-semibold text-neutral-700 mb-2">No locations yet</h2>
          <p class="text-neutral-500">
            Check back soon for our office locations and service areas.
          </p>
        </div>
      )
    }
  </div>
</PageLayout>
